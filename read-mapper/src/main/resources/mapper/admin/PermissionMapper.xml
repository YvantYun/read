<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yvant.mapper.admin.PermissionMapper">

    <select id="getPermissionList" parameterType="java.lang.Long" resultType="com.yvant.model.admin.Permission">
        SELECT
            p.id,p.pid,p.`name`,p.`value`,p.icon, p.type, p.uri, p.`status`
        FROM
            sys_admin_role ar, sys_role r,sys_role_permission rp, sys_permission p
        WHERE
            ar.role_id = r.id
            AND r.id = rp.role_id
            AND rp.permission_id = p.id
            AND p.deleted = 0
            AND ar.deleted = 0
            AND r.deleted = 0
            AND rp.deleted = 0
            AND p.`status` = 1
            <if test="adminId != null" >
                AND ar.admin_id = #{adminId}
            </if>
    </select>

</mapper>
